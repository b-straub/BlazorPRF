function ve(e){e.fill(0)}function Ft(e){return btoa(String.fromCharCode(...e))}function Vr(e){let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}function sn(e){return Ft(new Uint8Array(e))}function cn(e){return Vr(e).buffer}async function fn(){return!(!window.PublicKeyCredential||typeof PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable=="function"&&!await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable())}async function an(){return typeof PublicKeyCredential>"u"||typeof PublicKeyCredential.isConditionalMediationAvailable!="function"?!1:await PublicKeyCredential.isConditionalMediationAvailable()}async function un(e,t){try{let n=crypto.getRandomValues(new Uint8Array(16)),r=e??t.rpName,o=t.authenticatorAttachment==="platform"?"platform":"cross-platform",s={challenge:crypto.getRandomValues(new Uint8Array(32)),rp:{name:t.rpName,id:t.rpId??window.location.hostname},user:{id:n,name:r,displayName:r},pubKeyCredParams:[{alg:-7,type:"public-key"},{alg:-257,type:"public-key"}],authenticatorSelection:{authenticatorAttachment:o,residentKey:"required",userVerification:"discouraged"},timeout:t.timeoutMs,attestation:"none",extensions:{prf:{}}},i=await navigator.credentials.create({publicKey:s});return i===null?{success:!1,cancelled:!0}:i.getClientExtensionResults().prf?.enabled?{success:!0,value:{id:i.id,rawId:sn(i.rawId)}}:{success:!1,errorCode:"PrfNotSupported"}}catch(n){return n instanceof DOMException&&n.name==="NotAllowedError"?{success:!1,cancelled:!0}:{success:!1,errorCode:"RegistrationFailed"}}}async function ln(e){let t=await crypto.subtle.digest("SHA-256",e);return new Uint8Array(t)}async function dn(e,t,n){let r=null;try{let s=new TextEncoder().encode(t),i=await ln(s),c=cn(e),f=n.authenticatorAttachment==="platform"?["internal"]:["internal","usb","nfc","ble"],l={challenge:crypto.getRandomValues(new Uint8Array(32)),allowCredentials:[{id:c,type:"public-key",transports:f}],timeout:n.timeoutMs,userVerification:"required",extensions:{prf:{eval:{first:i.buffer}}}},u=await navigator.credentials.get({publicKey:l});if(u===null)return{success:!1,cancelled:!0};let a=u.getClientExtensionResults().prf?.results;return a?.first?(r=new Uint8Array(a.first),r.length!==32?{success:!1,errorCode:"KeyDerivationFailed"}:{success:!0,value:Ft(r)}):{success:!1,errorCode:"PrfNotSupported"}}catch(o){return o instanceof DOMException&&o.name==="NotAllowedError"?{success:!1,cancelled:!0}:{success:!1,errorCode:"KeyDerivationFailed"}}finally{r&&ve(r)}}async function hn(e,t){let n=null;try{let o=new TextEncoder().encode(e),s=await ln(o),i={challenge:crypto.getRandomValues(new Uint8Array(32)),rpId:t.rpId??window.location.hostname,timeout:t.timeoutMs,userVerification:"required",extensions:{prf:{eval:{first:s.buffer}}}},c=await navigator.credentials.get({publicKey:i});if(c===null)return{success:!1,cancelled:!0};let l=c.getClientExtensionResults().prf?.results;if(!l?.first)return{success:!1,errorCode:"PrfNotSupported"};if(n=new Uint8Array(l.first),n.length!==32)return{success:!1,errorCode:"KeyDerivationFailed"};let u=Ft(n);return{success:!0,value:{credentialId:Ft(new Uint8Array(c.rawId)),prfOutput:u}}}catch(r){return r instanceof DOMException&&r.name==="NotAllowedError"?{success:!1,cancelled:!0}:{success:!1,errorCode:"KeyDerivationFailed"}}finally{n&&ve(n)}}var Ut=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function It(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Nt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function j(e,...t){if(!It(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function jt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Nt(e.outputLen),Nt(e.blockLen)}function Dt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function yn(e,t){j(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function nt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function se(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rt(e,t){return e<<32-t|e>>>t}var xn=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",$r=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Pt(e){if(j(e),xn)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=$r[e[n]];return t}var yt={_0:48,_9:57,A:65,F:70,a:97,f:102};function pn(e){if(e>=yt._0&&e<=yt._9)return e-yt._0;if(e>=yt.A&&e<=yt.F)return e-(yt.A-10);if(e>=yt.a&&e<=yt.f)return e-(yt.a-10)}function ie(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(xn)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=pn(e.charCodeAt(s)),c=pn(e.charCodeAt(s+1));if(i===void 0||c===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[o]=i*16+c}return r}function Ce(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function vt(e){return typeof e=="string"&&(e=Ce(e)),j(e),e}function qt(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];j(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}var kt=class{};function Oe(e){let t=r=>e().update(vt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Xt(e=32){if(Ut&&typeof Ut.getRandomValues=="function")return Ut.getRandomValues(new Uint8Array(e));if(Ut&&typeof Ut.randomBytes=="function")return Uint8Array.from(Ut.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function Fr(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,l=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+l,c,r)}function gn(e,t,n){return e&t^~e&n}function mn(e,t,n){return e&t^e&n^t&n}var zt=class extends kt{constructor(t,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=se(this.buffer)}update(t){Dt(this),t=vt(t),j(t);let{view:n,buffer:r,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let f=se(t);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Dt(this),yn(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,nt(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(r,0),i=0);for(let d=i;d<o;d++)n[d]=0;Fr(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=se(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=f/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)c.setUint32(4*d,u[d],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=c,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}},xt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var Z=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var ce=BigInt(4294967295),bn=BigInt(32);function jr(e,t=!1){return t?{h:Number(e&ce),l:Number(e>>bn&ce)}:{h:Number(e>>bn&ce)|0,l:Number(e&ce)|0}}function wn(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){let{h:i,l:c}=jr(e[s],t);[r[s],o[s]]=[i,c]}return[r,o]}var _e=(e,t,n)=>e>>>n,Ke=(e,t,n)=>e<<32-n|t>>>n,Tt=(e,t,n)=>e>>>n|t<<32-n,Lt=(e,t,n)=>e<<32-n|t>>>n,Yt=(e,t,n)=>e<<64-n|t>>>n-32,Wt=(e,t,n)=>e>>>n-32|t<<64-n;function ut(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Bn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),An=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,En=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Sn=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,vn=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),Cn=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;var zr=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ct=new Uint32Array(64),fe=class extends zt{constructor(t=32){super(64,t,8,!1),this.A=xt[0]|0,this.B=xt[1]|0,this.C=xt[2]|0,this.D=xt[3]|0,this.E=xt[4]|0,this.F=xt[5]|0,this.G=xt[6]|0,this.H=xt[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:f}=this;return[t,n,r,o,s,i,c,f]}set(t,n,r,o,s,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let d=0;d<16;d++,n+=4)Ct[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){let a=Ct[d-15],y=Ct[d-2],h=rt(a,7)^rt(a,18)^a>>>3,g=rt(y,17)^rt(y,19)^y>>>10;Ct[d]=g+Ct[d-7]+h+Ct[d-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:f,G:l,H:u}=this;for(let d=0;d<64;d++){let a=rt(c,6)^rt(c,11)^rt(c,25),y=u+a+gn(c,f,l)+zr[d]+Ct[d]|0,g=(rt(r,2)^rt(r,13)^rt(r,22))+mn(r,o,s)|0;u=l,l=f,f=c,c=i+y|0,i=s,s=o,o=r,r=y+g|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,o,s,i,c,f,l,u)}roundClean(){nt(Ct)}destroy(){this.set(0,0,0,0,0,0,0,0),nt(this.buffer)}};var On=wn(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Yr=On[0],Wr=On[1],Ot=new Uint32Array(80),_t=new Uint32Array(80),Ue=class extends zt{constructor(t=64){super(128,t,16,!1),this.Ah=Z[0]|0,this.Al=Z[1]|0,this.Bh=Z[2]|0,this.Bl=Z[3]|0,this.Ch=Z[4]|0,this.Cl=Z[5]|0,this.Dh=Z[6]|0,this.Dl=Z[7]|0,this.Eh=Z[8]|0,this.El=Z[9]|0,this.Fh=Z[10]|0,this.Fl=Z[11]|0,this.Gh=Z[12]|0,this.Gl=Z[13]|0,this.Hh=Z[14]|0,this.Hl=Z[15]|0}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:f,Eh:l,El:u,Fh:d,Fl:a,Gh:y,Gl:h,Hh:g,Hl:x}=this;return[t,n,r,o,s,i,c,f,l,u,d,a,y,h,g,x]}set(t,n,r,o,s,i,c,f,l,u,d,a,y,h,g,x){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=f|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=a|0,this.Gh=y|0,this.Gl=h|0,this.Hh=g|0,this.Hl=x|0}process(t,n){for(let m=0;m<16;m++,n+=4)Ot[m]=t.getUint32(n),_t[m]=t.getUint32(n+=4);for(let m=16;m<80;m++){let O=Ot[m-15]|0,T=_t[m-15]|0,L=Tt(O,T,1)^Tt(O,T,8)^_e(O,T,7),I=Lt(O,T,1)^Lt(O,T,8)^Ke(O,T,7),U=Ot[m-2]|0,b=_t[m-2]|0,B=Tt(U,b,19)^Yt(U,b,61)^_e(U,b,6),v=Lt(U,b,19)^Wt(U,b,61)^Ke(U,b,6),_=En(I,v,_t[m-7],_t[m-16]),A=Sn(_,L,B,Ot[m-7],Ot[m-16]);Ot[m]=A|0,_t[m]=_|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:f,Dh:l,Dl:u,Eh:d,El:a,Fh:y,Fl:h,Gh:g,Gl:x,Hh:p,Hl:w}=this;for(let m=0;m<80;m++){let O=Tt(d,a,14)^Tt(d,a,18)^Yt(d,a,41),T=Lt(d,a,14)^Lt(d,a,18)^Wt(d,a,41),L=d&y^~d&g,I=a&h^~a&x,U=vn(w,T,I,Wr[m],_t[m]),b=Cn(U,p,O,L,Yr[m],Ot[m]),B=U|0,v=Tt(r,o,28)^Yt(r,o,34)^Yt(r,o,39),_=Lt(r,o,28)^Wt(r,o,34)^Wt(r,o,39),A=r&s^r&c^s&c,S=o&i^o&f^i&f;p=g|0,w=x|0,g=y|0,x=h|0,y=d|0,h=a|0,{h:d,l:a}=ut(l|0,u|0,b|0,B|0),l=c|0,u=f|0,c=s|0,f=i|0,s=r|0,i=o|0;let K=Bn(B,_,S);r=An(K,b,v,A),o=K|0}({h:r,l:o}=ut(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=ut(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:f}=ut(this.Ch|0,this.Cl|0,c|0,f|0),{h:l,l:u}=ut(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:a}=ut(this.Eh|0,this.El|0,d|0,a|0),{h:y,l:h}=ut(this.Fh|0,this.Fl|0,y|0,h|0),{h:g,l:x}=ut(this.Gh|0,this.Gl|0,g|0,x|0),{h:p,l:w}=ut(this.Hh|0,this.Hl|0,p|0,w|0),this.set(r,o,s,i,c,f,l,u,d,a,y,h,g,x,p,w)}roundClean(){nt(Ot,_t)}destroy(){nt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var _n=Oe(()=>new fe);var Kn=Oe(()=>new Ue);var Pe=BigInt(0),Ie=BigInt(1);function ae(e,t=""){if(typeof e!="boolean"){let n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function Qt(e,t,n=""){let r=It(e),o=e?.length,s=t!==void 0;if(!r||s&&o!==t){let i=n&&`"${n}" `,c=s?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(i+"expected Uint8Array"+c+", got "+f)}return e}function Un(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Pe:BigInt("0x"+e)}function Nn(e){return Un(Pt(e))}function ot(e){return j(e),Un(Pt(Uint8Array.from(e).reverse()))}function Te(e,t){return ie(e.toString(16).padStart(t*2,"0"))}function ue(e,t){return Te(e,t).reverse()}function X(e,t,n){let r;if(typeof t=="string")try{r=ie(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(It(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(e+" of length "+n+" expected, got "+o);return r}function In(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function Le(e){return Uint8Array.from(e)}var Ne=e=>typeof e=="bigint"&&Pe<=e;function Qr(e,t,n){return Ne(e)&&Ne(t)&&Ne(n)&&t<=e&&e<n}function Gt(e,t,n,r){if(!Qr(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function Pn(e){let t;for(t=0;e>Pe;e>>=Ie,t+=1);return t}var te=e=>(Ie<<BigInt(e))-Ie;function Ht(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(o,s,i){let c=e[o];if(i&&c===void 0)return;let f=typeof c;if(f!==s||c===null)throw new Error(`param "${o}" is invalid: expected ${s}, got ${f}`)}Object.entries(t).forEach(([o,s])=>r(o,s,!1)),Object.entries(n).forEach(([o,s])=>r(o,s,!0))}var He=()=>{throw new Error("not implemented")};function Re(e){let t=new WeakMap;return(n,...r)=>{let o=t.get(n);if(o!==void 0)return o;let s=e(n,...r);return t.set(n,s),s}}var Q=BigInt(0),z=BigInt(1),Rt=BigInt(2),Hn=BigInt(3),Rn=BigInt(4),Mn=BigInt(5),to=BigInt(7),kn=BigInt(8),eo=BigInt(9),Dn=BigInt(16);function J(e,t){let n=e%t;return n>=Q?n:t+n}function et(e,t,n){let r=e;for(;t-- >Q;)r*=r,r%=n;return r}function Tn(e,t){if(e===Q)throw new Error("invert: expected non-zero number");if(t<=Q)throw new Error("invert: expected positive modulus, got "+t);let n=J(e,t),r=t,o=Q,s=z,i=z,c=Q;for(;n!==Q;){let l=r/n,u=r%n,d=o-i*l,a=s-c*l;r=n,n=u,o=i,s=c,i=d,c=a}if(r!==z)throw new Error("invert: does not exist");return J(o,t)}function Me(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function qn(e,t){let n=(e.ORDER+z)/Rn,r=e.pow(t,n);return Me(e,r,t),r}function no(e,t){let n=(e.ORDER-Mn)/kn,r=e.mul(t,Rt),o=e.pow(r,n),s=e.mul(t,o),i=e.mul(e.mul(s,Rt),o),c=e.mul(s,e.sub(i,e.ONE));return Me(e,c,t),c}function ro(e){let t=mt(e),n=Gn(e),r=n(t,t.neg(t.ONE)),o=n(t,r),s=n(t,t.neg(r)),i=(e+to)/Dn;return(c,f)=>{let l=c.pow(f,i),u=c.mul(l,r),d=c.mul(l,o),a=c.mul(l,s),y=c.eql(c.sqr(u),f),h=c.eql(c.sqr(d),f);l=c.cmov(l,u,y),u=c.cmov(a,d,h);let g=c.eql(c.sqr(u),f),x=c.cmov(l,u,g);return Me(c,x,f),x}}function Gn(e){if(e<Hn)throw new Error("sqrt is not defined for small field");let t=e-z,n=0;for(;t%Rt===Q;)t/=Rt,n++;let r=Rt,o=mt(e);for(;Ln(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return qn;let s=o.pow(r,t),i=(t+z)/Rt;return function(f,l){if(f.is0(l))return l;if(Ln(f,l)!==1)throw new Error("Cannot find square root");let u=n,d=f.mul(f.ONE,s),a=f.pow(l,t),y=f.pow(l,i);for(;!f.eql(a,f.ONE);){if(f.is0(a))return f.ZERO;let h=1,g=f.sqr(a);for(;!f.eql(g,f.ONE);)if(h++,g=f.sqr(g),h===u)throw new Error("Cannot find square root");let x=z<<BigInt(u-h-1),p=f.pow(d,x);u=h,d=f.sqr(p),a=f.mul(a,d),y=f.mul(y,p)}return y}}function oo(e){return e%Rn===Hn?qn:e%kn===Mn?no:e%Dn===eo?ro(e):Gn(e)}var gt=(e,t)=>(J(e,t)&z)===z,so=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Jn(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=so.reduce((r,o)=>(r[o]="function",r),t);return Ht(e,n),e}function io(e,t,n){if(n<Q)throw new Error("invalid exponent, negatives unsupported");if(n===Q)return e.ONE;if(n===z)return t;let r=e.ONE,o=t;for(;n>Q;)n&z&&(r=e.mul(r,o)),o=e.sqr(o),n>>=z;return r}function le(e,t,n=!1){let r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((i,c,f)=>e.is0(c)?i:(r[f]=i,e.mul(i,c)),e.ONE),s=e.inv(o);return t.reduceRight((i,c,f)=>e.is0(c)?i:(r[f]=e.mul(i,r[f]),e.mul(i,c)),s),r}function Ln(e,t){let n=(e.ORDER-z)/Rt,r=e.pow(t,n),o=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),i=e.eql(r,e.neg(e.ONE));if(!o&&!s&&!i)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function Vn(e,t){t!==void 0&&Nt(t);let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function mt(e,t,n=!1,r={}){if(e<=Q)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,s,i=!1,c;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");let a=t;a.BITS&&(o=a.BITS),a.sqrt&&(s=a.sqrt),typeof a.isLE=="boolean"&&(n=a.isLE),typeof a.modFromBytes=="boolean"&&(i=a.modFromBytes),c=a.allowedLengths}else typeof t=="number"&&(o=t),r.sqrt&&(s=r.sqrt);let{nBitLength:f,nByteLength:l}=Vn(e,o);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u,d=Object.freeze({ORDER:e,isLE:n,BITS:f,BYTES:l,MASK:te(f),ZERO:Q,ONE:z,allowedLengths:c,create:a=>J(a,e),isValid:a=>{if(typeof a!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof a);return Q<=a&&a<e},is0:a=>a===Q,isValidNot0:a=>!d.is0(a)&&d.isValid(a),isOdd:a=>(a&z)===z,neg:a=>J(-a,e),eql:(a,y)=>a===y,sqr:a=>J(a*a,e),add:(a,y)=>J(a+y,e),sub:(a,y)=>J(a-y,e),mul:(a,y)=>J(a*y,e),pow:(a,y)=>io(d,a,y),div:(a,y)=>J(a*Tn(y,e),e),sqrN:a=>a*a,addN:(a,y)=>a+y,subN:(a,y)=>a-y,mulN:(a,y)=>a*y,inv:a=>Tn(a,e),sqrt:s||(a=>(u||(u=oo(e)),u(d,a))),toBytes:a=>n?ue(a,l):Te(a,l),fromBytes:(a,y=!0)=>{if(c){if(!c.includes(a.length)||a.length>l)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+a.length);let g=new Uint8Array(l);g.set(a,n?0:g.length-a.length),a=g}if(a.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+a.length);let h=n?ot(a):Nn(a);if(i&&(h=J(h,e)),!y&&!d.isValid(h))throw new Error("invalid field element: outside of range 0..ORDER");return h},invertBatch:a=>le(d,a),cmov:(a,y,h)=>h?y:a});return Object.freeze(d)}var de=BigInt(0),Ge=BigInt(1);function Zn(e,t){let n=t.negate();return e?n:t}function ee(e,t){let n=le(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function Xn(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function ke(e,t){Xn(e,t);let n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,s=te(e),i=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:o,shiftBy:i}}function $n(e,t,n){let{windowSize:r,mask:o,maxNumber:s,shiftBy:i}=n,c=Number(e&o),f=e>>i;c>r&&(c-=s,f+=Ge);let l=t*r,u=l+Math.abs(c)-1,d=c===0,a=c<0,y=t%2!==0;return{nextN:f,offset:u,isZero:d,isNeg:a,isNegF:y,offsetF:l}}function co(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function fo(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}var De=new WeakMap,zn=new WeakMap;function qe(e){return zn.get(e)||1}function Fn(e){if(e!==de)throw new Error("invalid wNAF")}var he=class{constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>de;)n&Ge&&(r=r.add(o)),o=o.double(),n>>=Ge;return r}precomputeWindow(t,n){let{windows:r,windowSize:o}=ke(n,this.bits),s=[],i=t,c=i;for(let f=0;f<r;f++){c=i,s.push(c);for(let l=1;l<o;l++)c=c.add(i),s.push(c);i=c.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,s=this.BASE,i=ke(t,this.bits);for(let c=0;c<i.windows;c++){let{nextN:f,offset:l,isZero:u,isNeg:d,isNegF:a,offsetF:y}=$n(r,c,i);r=f,u?s=s.add(Zn(a,n[y])):o=o.add(Zn(d,n[l]))}return Fn(r),{p:o,f:s}}wNAFUnsafe(t,n,r,o=this.ZERO){let s=ke(t,this.bits);for(let i=0;i<s.windows&&r!==de;i++){let{nextN:c,offset:f,isZero:l,isNeg:u}=$n(r,i,s);if(r=c,!l){let d=n[f];o=o.add(u?d.negate():d)}}return Fn(r),o}getPrecomputes(t,n,r){let o=De.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),De.set(n,o))),o}cached(t,n,r){let o=qe(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){let s=qe(t);return s===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,o)}createCache(t,n){Xn(n,this.bits),zn.set(t,n),De.delete(t)}hasCache(t){return qe(t)!==1}};function pe(e,t,n,r){co(n,e),fo(r,t);let o=n.length,s=r.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");let i=e.ZERO,c=Pn(BigInt(o)),f=1;c>12?f=c-3:c>4?f=c-2:c>0&&(f=2);let l=te(f),u=new Array(Number(l)+1).fill(i),d=Math.floor((t.BITS-1)/f)*f,a=i;for(let y=d;y>=0;y-=f){u.fill(i);for(let g=0;g<s;g++){let x=r[g],p=Number(x>>BigInt(y)&l);u[p]=u[p].add(n[g])}let h=i;for(let g=u.length-1,x=i;g>0;g--)x=x.add(u[g]),h=h.add(x);if(a=a.add(h),y!==0)for(let g=0;g<f;g++)a=a.double()}return a}function jn(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Jn(t),t}else return mt(e,{isLE:n})}function Yn(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let f of["p","n","h"]){let l=t[f];if(!(typeof l=="bigint"&&l>de))throw new Error(`CURVE.${f} must be positive bigint`)}let o=jn(t.p,n.Fp,r),s=jn(t.n,n.Fn,r),c=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let f of c)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:s}}var Kt=BigInt(0),V=BigInt(1),Je=BigInt(2),ao=BigInt(8);function uo(e,t,n,r){let o=e.sqr(n),s=e.sqr(r),i=e.add(e.mul(t.a,o),s),c=e.add(e.ONE,e.mul(t.d,e.mul(o,s)));return e.eql(i,c)}function lo(e,t={}){let n=Yn("edwards",e,t,t.FpFnLE),{Fp:r,Fn:o}=n,s=n.CURVE,{h:i}=s;Ht(t,{},{uvRatio:"function"});let c=Je<<BigInt(o.BYTES*8)-V,f=x=>r.create(x),l=t.uvRatio||((x,p)=>{try{return{isValid:!0,value:r.sqrt(r.div(x,p))}}catch{return{isValid:!1,value:Kt}}});if(!uo(r,s,s.Gx,s.Gy))throw new Error("bad curve params: generator point");function u(x,p,w=!1){let m=w?V:Kt;return Gt("coordinate "+x,p,m,c),p}function d(x){if(!(x instanceof h))throw new Error("ExtendedPoint expected")}let a=Re((x,p)=>{let{X:w,Y:m,Z:O}=x,T=x.is0();p==null&&(p=T?ao:r.inv(O));let L=f(w*p),I=f(m*p),U=r.mul(O,p);if(T)return{x:Kt,y:V};if(U!==V)throw new Error("invZ was invalid");return{x:L,y:I}}),y=Re(x=>{let{a:p,d:w}=s;if(x.is0())throw new Error("bad point: ZERO");let{X:m,Y:O,Z:T,T:L}=x,I=f(m*m),U=f(O*O),b=f(T*T),B=f(b*b),v=f(I*p),_=f(b*f(v+U)),A=f(B+f(w*f(I*U)));if(_!==A)throw new Error("bad point: equation left != right (1)");let S=f(m*O),K=f(T*L);if(S!==K)throw new Error("bad point: equation left != right (2)");return!0});class h{constructor(p,w,m,O){this.X=u("x",p),this.Y=u("y",w),this.Z=u("z",m,!0),this.T=u("t",O),Object.freeze(this)}static CURVE(){return s}static fromAffine(p){if(p instanceof h)throw new Error("extended point not allowed");let{x:w,y:m}=p||{};return u("x",w),u("y",m),new h(w,m,V,f(w*m))}static fromBytes(p,w=!1){let m=r.BYTES,{a:O,d:T}=s;p=Le(Qt(p,m,"point")),ae(w,"zip215");let L=Le(p),I=p[m-1];L[m-1]=I&-129;let U=ot(L),b=w?c:r.ORDER;Gt("point.y",U,Kt,b);let B=f(U*U),v=f(B-V),_=f(T*B-O),{isValid:A,value:S}=l(v,_);if(!A)throw new Error("bad point: invalid y coordinate");let K=(S&V)===V,N=(I&128)!==0;if(!w&&S===Kt&&N)throw new Error("bad point: x=0 and x_0=1");return N!==K&&(S=f(-S)),h.fromAffine({x:S,y:U})}static fromHex(p,w=!1){return h.fromBytes(X("point",p),w)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(p=8,w=!0){return g.createCache(this,p),w||this.multiply(Je),this}assertValidity(){y(this)}equals(p){d(p);let{X:w,Y:m,Z:O}=this,{X:T,Y:L,Z:I}=p,U=f(w*I),b=f(T*O),B=f(m*I),v=f(L*O);return U===b&&B===v}is0(){return this.equals(h.ZERO)}negate(){return new h(f(-this.X),this.Y,this.Z,f(-this.T))}double(){let{a:p}=s,{X:w,Y:m,Z:O}=this,T=f(w*w),L=f(m*m),I=f(Je*f(O*O)),U=f(p*T),b=w+m,B=f(f(b*b)-T-L),v=U+L,_=v-I,A=U-L,S=f(B*_),K=f(v*A),N=f(B*A),P=f(_*v);return new h(S,K,P,N)}add(p){d(p);let{a:w,d:m}=s,{X:O,Y:T,Z:L,T:I}=this,{X:U,Y:b,Z:B,T:v}=p,_=f(O*U),A=f(T*b),S=f(I*m*v),K=f(L*B),N=f((O+T)*(U+b)-_-A),P=K-S,H=K+S,E=f(A-w*_),R=f(N*P),M=f(H*E),G=f(N*E),F=f(P*H);return new h(R,M,F,G)}subtract(p){return this.add(p.negate())}multiply(p){if(!o.isValidNot0(p))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:w,f:m}=g.cached(this,p,O=>ee(h,O));return ee(h,[w,m])[0]}multiplyUnsafe(p,w=h.ZERO){if(!o.isValid(p))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return p===Kt?h.ZERO:this.is0()||p===V?this:g.unsafe(this,p,m=>ee(h,m),w)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return g.unsafe(this,s.n).is0()}toAffine(p){return a(this,p)}clearCofactor(){return i===V?this:this.multiplyUnsafe(i)}toBytes(){let{x:p,y:w}=this.toAffine(),m=r.toBytes(w);return m[m.length-1]|=p&V?128:0,m}toHex(){return Pt(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(p){return ee(h,p)}static msm(p,w){return pe(h,o,p,w)}_setWindowSize(p){this.precompute(p)}toRawBytes(){return this.toBytes()}}h.BASE=new h(s.Gx,s.Gy,V,f(s.Gx*s.Gy)),h.ZERO=new h(Kt,V,V,Kt),h.Fp=r,h.Fn=o;let g=new he(h,o.BITS);return h.BASE.precompute(8),h}var ye=class{constructor(t){this.ep=t}static fromBytes(t){He()}static fromHex(t){He()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return Pt(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,n){return this.init(this.ep.precompute(t,n))}toRawBytes(){return this.toBytes()}};function ho(e,t,n={}){if(typeof t!="function")throw new Error('"hash" function param is required');Ht(n,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:r}=n,{BASE:o,Fp:s,Fn:i}=e,c=n.randomBytes||Xt,f=n.adjustScalarBytes||(b=>b),l=n.domain||((b,B,v)=>{if(ae(v,"phflag"),B.length||v)throw new Error("Contexts/pre-hash are not supported");return b});function u(b){return i.create(ot(b))}function d(b){let B=m.secretKey;b=X("private key",b,B);let v=X("hashed private key",t(b),2*B),_=f(v.slice(0,B)),A=v.slice(B,2*B),S=u(_);return{head:_,prefix:A,scalar:S}}function a(b){let{head:B,prefix:v,scalar:_}=d(b),A=o.multiply(_),S=A.toBytes();return{head:B,prefix:v,scalar:_,point:A,pointBytes:S}}function y(b){return a(b).pointBytes}function h(b=Uint8Array.of(),...B){let v=qt(...B);return u(t(l(v,X("context",b),!!r)))}function g(b,B,v={}){b=X("message",b),r&&(b=r(b));let{prefix:_,scalar:A,pointBytes:S}=a(B),K=h(v.context,_,b),N=o.multiply(K).toBytes(),P=h(v.context,N,S,b),H=i.create(K+P*A);if(!i.isValid(H))throw new Error("sign failed: invalid s");let E=qt(N,i.toBytes(H));return Qt(E,m.signature,"result")}let x={zip215:!0};function p(b,B,v,_=x){let{context:A,zip215:S}=_,K=m.signature;b=X("signature",b,K),B=X("message",B),v=X("publicKey",v,m.publicKey),S!==void 0&&ae(S,"zip215"),r&&(B=r(B));let N=K/2,P=b.subarray(0,N),H=ot(b.subarray(N,K)),E,R,M;try{E=e.fromBytes(v,S),R=e.fromBytes(P,S),M=o.multiplyUnsafe(H)}catch{return!1}if(!S&&E.isSmallOrder())return!1;let G=h(A,R.toBytes(),E.toBytes(),B);return R.add(E.multiplyUnsafe(G)).subtract(M).clearCofactor().is0()}let w=s.BYTES,m={secretKey:w,publicKey:w,signature:2*w,seed:w};function O(b=c(m.seed)){return Qt(b,m.seed,"seed")}function T(b){let B=U.randomSecretKey(b);return{secretKey:B,publicKey:y(B)}}function L(b){return It(b)&&b.length===i.BYTES}function I(b,B){try{return!!e.fromBytes(b,B)}catch{return!1}}let U={getExtendedPublicKey:a,randomSecretKey:O,isValidSecretKey:L,isValidPublicKey:I,toMontgomery(b){let{y:B}=e.fromBytes(b),v=m.publicKey,_=v===32;if(!_&&v!==57)throw new Error("only defined for 25519 and 448");let A=_?s.div(V+B,V-B):s.div(B-V,B+V);return s.toBytes(A)},toMontgomerySecret(b){let B=m.secretKey;Qt(b,B);let v=t(b.subarray(0,B));return f(v).subarray(0,B)},randomPrivateKey:O,precompute(b=8,B=e.BASE){return B.precompute(b,!1)}};return Object.freeze({keygen:T,getPublicKey:y,sign:g,verify:p,utils:U,Point:e,lengths:m})}function po(e){let t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=mt(t.n,e.nBitLength,!0),o={Fp:n,Fn:r,uvRatio:e.uvRatio},s={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:o,hash:e.hash,eddsaOpts:s}}function yo(e,t){let n=t.Point;return Object.assign({},t,{ExtendedPoint:n,CURVE:e,nBitLength:n.Fn.BITS,nByteLength:n.Fn.BYTES})}function Wn(e){let{CURVE:t,curveOpts:n,hash:r,eddsaOpts:o}=po(e),s=lo(t,n),i=ho(s,r,o);return yo(e,i)}var ne=BigInt(0),Jt=BigInt(1),xe=BigInt(2);function xo(e){return Ht(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function Qn(e){let t=xo(e),{P:n,type:r,adjustScalarBytes:o,powPminus2:s,randomBytes:i}=t,c=r==="x25519";if(!c&&r!=="x448")throw new Error("invalid type");let f=i||Xt,l=c?255:448,u=c?32:56,d=BigInt(c?9:5),a=BigInt(c?121665:39081),y=c?xe**BigInt(254):xe**BigInt(447),h=c?BigInt(8)*xe**BigInt(251)-Jt:BigInt(4)*xe**BigInt(445)-Jt,g=y+h+Jt,x=A=>J(A,n),p=w(d);function w(A){return ue(x(A),u)}function m(A){let S=X("u coordinate",A,u);return c&&(S[31]&=127),x(ot(S))}function O(A){return ot(o(X("scalar",A,u)))}function T(A,S){let K=U(m(S),O(A));if(K===ne)throw new Error("invalid private or public key received");return w(K)}function L(A){return T(A,p)}function I(A,S,K){let N=x(A*(S-K));return S=x(S-N),K=x(K+N),{x_2:S,x_3:K}}function U(A,S){Gt("u",A,ne,n),Gt("scalar",S,y,g);let K=S,N=A,P=Jt,H=ne,E=A,R=Jt,M=ne;for(let F=BigInt(l-1);F>=ne;F--){let it=K>>F&Jt;M^=it,{x_2:P,x_3:E}=I(M,P,E),{x_2:H,x_3:R}=I(M,H,R),M=it;let ct=P+H,ft=x(ct*ct),at=P-H,ht=x(at*at),pt=ft-ht,Gr=E+R,Jr=E-R,en=x(Jr*ct),nn=x(Gr*at),rn=en+nn,on=en-nn;E=x(rn*rn),R=x(N*x(on*on)),P=x(ft*ht),H=x(pt*(ft+x(a*pt)))}({x_2:P,x_3:E}=I(M,P,E)),{x_2:H,x_3:R}=I(M,H,R);let G=s(H);return x(P*G)}let b={secretKey:u,publicKey:u,seed:u},B=(A=f(u))=>(j(A,b.seed),A);function v(A){let S=B(A);return{secretKey:S,publicKey:L(S)}}return{keygen:v,getSharedSecret:(A,S)=>T(A,S),getPublicKey:A=>L(A),scalarMult:T,scalarMultBase:L,utils:{randomSecretKey:B,randomPrivateKey:B},GuBytes:p.slice(),lengths:b}}var go=BigInt(0),wt=BigInt(1),tr=BigInt(2),mo=BigInt(3),bo=BigInt(5),wo=BigInt(8),Vt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),re={p:Vt,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:wo,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function rr(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=Vt,c=e*e%s*e%s,f=et(c,tr,s)*c%s,l=et(f,wt,s)*e%s,u=et(l,bo,s)*l%s,d=et(u,t,s)*u%s,a=et(d,n,s)*d%s,y=et(a,r,s)*a%s,h=et(y,o,s)*y%s,g=et(h,o,s)*y%s,x=et(g,t,s)*u%s;return{pow_p_5_8:et(x,tr,s)*e%s,b2:c}}function or(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var Ve=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Fe(e,t){let n=Vt,r=J(t*t*t,n),o=J(r*r*t,n),s=rr(e*o).pow_p_5_8,i=J(e*r*s,n),c=J(t*i*i,n),f=i,l=J(i*Ve,n),u=c===e,d=c===J(-e,n),a=c===J(-e*Ve,n);return u&&(i=f),(d||a)&&(i=l),gt(i,n)&&(i=J(-i,n)),{isValid:u||d,value:i}}var bt=mt(re.p,{isLE:!0}),Bo=mt(re.n,{isLE:!0}),Ao={...re,Fp:bt,hash:Kn,adjustScalarBytes:or,uvRatio:Fe},tt=Wn(Ao);var At=(()=>{let e=bt.ORDER;return Qn({P:e,type:"x25519",powPminus2:t=>{let{pow_p_5_8:n,b2:r}=rr(t);return J(et(n,mo,e)*r,e)},adjustScalarBytes:or})})();var Ze=Ve,Eo=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),So=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),vo=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Co=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),er=e=>Fe(wt,e),Oo=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),$e=e=>tt.Point.Fp.create(ot(e)&Oo);function nr(e){let{d:t}=re,n=Vt,r=p=>bt.create(p),o=r(Ze*e*e),s=r((o+wt)*vo),i=BigInt(-1),c=r((i-t*o)*r(o+t)),{isValid:f,value:l}=Fe(s,c),u=r(l*e);gt(u,n)||(u=r(-u)),f||(l=u),f||(i=o);let d=r(i*(o-wt)*Co-c),a=l*l,y=r((l+l)*c),h=r(d*Eo),g=r(wt-a),x=r(wt+a);return new tt.Point(r(y*x),r(g*h),r(h*x),r(y*g))}function _o(e){j(e,64);let t=$e(e.subarray(0,32)),n=nr(t),r=$e(e.subarray(32,64)),o=nr(r);return new Bt(n.add(o))}var Bt=class e extends ye{constructor(t){super(t)}static fromAffine(t){return new e(tt.Point.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static hashToCurve(t){return _o(X("ristrettoHash",t,64))}static fromBytes(t){j(t,32);let{a:n,d:r}=re,o=Vt,s=O=>bt.create(O),i=$e(t);if(!In(bt.toBytes(i),t)||gt(i,o))throw new Error("invalid ristretto255 encoding 1");let c=s(i*i),f=s(wt+n*c),l=s(wt-n*c),u=s(f*f),d=s(l*l),a=s(n*r*u-d),{isValid:y,value:h}=er(s(a*d)),g=s(h*l),x=s(h*g*a),p=s((i+i)*g);gt(p,o)&&(p=s(-p));let w=s(f*x),m=s(p*w);if(!y||gt(m,o)||w===go)throw new Error("invalid ristretto255 encoding 2");return new e(new tt.Point(p,w,wt,m))}static fromHex(t){return e.fromBytes(X("ristrettoHex",t,32))}static msm(t,n){return pe(e,tt.Point.Fn,t,n)}toBytes(){let{X:t,Y:n,Z:r,T:o}=this.ep,s=Vt,i=x=>bt.create(x),c=i(i(r+n)*i(r-n)),f=i(t*n),l=i(f*f),{value:u}=er(i(c*l)),d=i(u*c),a=i(u*f),y=i(d*a*o),h;if(gt(o*y,s)){let x=i(n*Ze),p=i(t*Ze);t=x,n=p,h=i(d*So)}else h=a;gt(t*y,s)&&(n=i(-n));let g=i((r-n)*h);return gt(g,s)&&(g=i(-g)),bt.toBytes(g)}equals(t){this.assertSame(t);let{X:n,Y:r}=this.ep,{X:o,Y:s}=t.ep,i=l=>bt.create(l),c=i(n*s)===i(r*o),f=i(r*s)===i(n*o);return c||f}is0(){return this.equals(e.ZERO)}};Bt.BASE=new Bt(tt.Point.BASE);Bt.ZERO=new Bt(tt.Point.ZERO);Bt.Fp=bt;Bt.Fn=Bo;function ir(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ge(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function me(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Y(e,...t){if(!ir(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function je(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function cr(e,t){Y(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Et(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function St(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Ko(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}var Uo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function No(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function be(e){if(typeof e=="string")e=No(e);else if(ir(e))e=we(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function fr(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function ar(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}var Xe=(e,t)=>{function n(r,...o){if(Y(r),!Uo)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let u=o[0];if(!u)throw new Error("nonce / iv required");e.varSizeNonce?Y(u):Y(u,e.nonceLength)}let s=e.tagLength;s&&o[1]!==void 0&&Y(o[1]);let i=t(r,...o),c=(u,d)=>{if(d!==void 0){if(u!==2)throw new Error("cipher output not supported");Y(d)}},f=!1;return{encrypt(u,d){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,Y(u),c(i.encrypt.length,d),i.encrypt(u,d)},decrypt(u,d){if(Y(u),s&&u.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return c(i.decrypt.length,d),i.decrypt(u,d)}}}return Object.assign(n,e),n};function ze(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!Io(t))throw new Error("invalid output, must be aligned");return t}function sr(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,l=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+l,c,r)}function ur(e,t,n){ge(n);let r=new Uint8Array(16),o=Ko(r);return sr(o,0,BigInt(t),n),sr(o,8,BigInt(e),n),r}function Io(e){return e.byteOffset%4===0}function we(e){return Uint8Array.from(e)}var dr=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Po=dr("expand 16-byte k"),To=dr("expand 32-byte k"),Lo=Et(Po),Ho=Et(To);function C(e,t){return e<<t|e>>>32-t}function Ye(e){return e.byteOffset%4===0}var Be=64,Ro=16,hr=2**32-1,lr=new Uint32Array;function Mo(e,t,n,r,o,s,i,c){let f=o.length,l=new Uint8Array(Be),u=Et(l),d=Ye(o)&&Ye(s),a=d?Et(o):lr,y=d?Et(s):lr;for(let h=0;h<f;i++){if(e(t,n,r,u,i,c),i>=hr)throw new Error("arx: counter overflow");let g=Math.min(Be,f-h);if(d&&g===Be){let x=h/4;if(h%4!==0)throw new Error("arx: invalid block position");for(let p=0,w;p<Ro;p++)w=x+p,y[w]=a[w]^u[p];h+=Be;continue}for(let x=0,p;x<g;x++)p=h+x,s[p]=o[p]^l[x];h+=g}}function We(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:s,rounds:i}=fr({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return me(o),me(i),ge(s),ge(n),(c,f,l,u,d=0)=>{Y(c),Y(f),Y(l);let a=l.length;if(u===void 0&&(u=new Uint8Array(a)),Y(u),me(d),d<0||d>=hr)throw new Error("arx: counter overflow");if(u.length<a)throw new Error(`arx: output (${u.length}) is shorter than data (${a})`);let y=[],h=c.length,g,x;if(h===32)y.push(g=we(c)),x=Ho;else if(h===16&&n)g=new Uint8Array(32),g.set(c),g.set(c,16),x=Lo,y.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${h}`);Ye(f)||y.push(f=we(f));let p=Et(g);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(x,p,Et(f.subarray(0,16)),p),f=f.subarray(16)}let w=16-o;if(w!==f.length)throw new Error(`arx: nonce must be ${w} or 16 bytes`);if(w!==12){let O=new Uint8Array(12);O.set(f,s?0:12-f.length),f=O,y.push(f)}let m=Et(f);return Mo(e,x,p,m,l,u,d,i),St(...y),u}}var $=(e,t)=>e[t++]&255|(e[t++]&255)<<8,Qe=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=be(t),Y(t,32);let n=$(t,0),r=$(t,2),o=$(t,4),s=$(t,6),i=$(t,8),c=$(t,10),f=$(t,12),l=$(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=$(t,16+2*u)}process(t,n,r=!1){let o=r?0:2048,{h:s,r:i}=this,c=i[0],f=i[1],l=i[2],u=i[3],d=i[4],a=i[5],y=i[6],h=i[7],g=i[8],x=i[9],p=$(t,n+0),w=$(t,n+2),m=$(t,n+4),O=$(t,n+6),T=$(t,n+8),L=$(t,n+10),I=$(t,n+12),U=$(t,n+14),b=s[0]+(p&8191),B=s[1]+((p>>>13|w<<3)&8191),v=s[2]+((w>>>10|m<<6)&8191),_=s[3]+((m>>>7|O<<9)&8191),A=s[4]+((O>>>4|T<<12)&8191),S=s[5]+(T>>>1&8191),K=s[6]+((T>>>14|L<<2)&8191),N=s[7]+((L>>>11|I<<5)&8191),P=s[8]+((I>>>8|U<<8)&8191),H=s[9]+(U>>>5|o),E=0,R=E+b*c+B*(5*x)+v*(5*g)+_*(5*h)+A*(5*y);E=R>>>13,R&=8191,R+=S*(5*a)+K*(5*d)+N*(5*u)+P*(5*l)+H*(5*f),E+=R>>>13,R&=8191;let M=E+b*f+B*c+v*(5*x)+_*(5*g)+A*(5*h);E=M>>>13,M&=8191,M+=S*(5*y)+K*(5*a)+N*(5*d)+P*(5*u)+H*(5*l),E+=M>>>13,M&=8191;let G=E+b*l+B*f+v*c+_*(5*x)+A*(5*g);E=G>>>13,G&=8191,G+=S*(5*h)+K*(5*y)+N*(5*a)+P*(5*d)+H*(5*u),E+=G>>>13,G&=8191;let F=E+b*u+B*l+v*f+_*c+A*(5*x);E=F>>>13,F&=8191,F+=S*(5*g)+K*(5*h)+N*(5*y)+P*(5*a)+H*(5*d),E+=F>>>13,F&=8191;let it=E+b*d+B*u+v*l+_*f+A*c;E=it>>>13,it&=8191,it+=S*(5*x)+K*(5*g)+N*(5*h)+P*(5*y)+H*(5*a),E+=it>>>13,it&=8191;let ct=E+b*a+B*d+v*u+_*l+A*f;E=ct>>>13,ct&=8191,ct+=S*c+K*(5*x)+N*(5*g)+P*(5*h)+H*(5*y),E+=ct>>>13,ct&=8191;let ft=E+b*y+B*a+v*d+_*u+A*l;E=ft>>>13,ft&=8191,ft+=S*f+K*c+N*(5*x)+P*(5*g)+H*(5*h),E+=ft>>>13,ft&=8191;let at=E+b*h+B*y+v*a+_*d+A*u;E=at>>>13,at&=8191,at+=S*l+K*f+N*c+P*(5*x)+H*(5*g),E+=at>>>13,at&=8191;let ht=E+b*g+B*h+v*y+_*a+A*d;E=ht>>>13,ht&=8191,ht+=S*u+K*l+N*f+P*c+H*(5*x),E+=ht>>>13,ht&=8191;let pt=E+b*x+B*g+v*h+_*y+A*a;E=pt>>>13,pt&=8191,pt+=S*d+K*u+N*l+P*f+H*c,E+=pt>>>13,pt&=8191,E=(E<<2)+E|0,E=E+R|0,R=E&8191,E=E>>>13,M+=E,s[0]=R,s[1]=M,s[2]=G,s[3]=F,s[4]=it,s[5]=ct,s[6]=ft,s[7]=at,s[8]=ht,s[9]=pt}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+o,o=r[c]>>>13,r[c]&=8191;r[9]-=8192;let s=(o^1)-1;for(let c=0;c<10;c++)r[c]&=s;s=~s;for(let c=0;c<10;c++)t[c]=t[c]&s|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535;St(r)}update(t){je(this),t=be(t),Y(t);let{buffer:n,blockLen:r}=this,o=t.length;for(let s=0;s<o;){let i=Math.min(r-this.pos,o-s);if(i===r){for(;r<=o-s;s+=r)this.process(t,s);continue}n.set(t.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){St(this.h,this.r,this.buffer,this.pad)}digestInto(t){je(this),cr(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let i=0;i<8;i++)t[s++]=r[i]>>>0,t[s++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function ko(e){let t=(r,o)=>e(o).update(be(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}var pr=ko(e=>new Qe(e));function gr(e,t,n,r,o,s=20){let i=e[0],c=e[1],f=e[2],l=e[3],u=t[0],d=t[1],a=t[2],y=t[3],h=t[4],g=t[5],x=t[6],p=t[7],w=o,m=n[0],O=n[1],T=n[2],L=i,I=c,U=f,b=l,B=u,v=d,_=a,A=y,S=h,K=g,N=x,P=p,H=w,E=m,R=O,M=T;for(let F=0;F<s;F+=2)L=L+B|0,H=C(H^L,16),S=S+H|0,B=C(B^S,12),L=L+B|0,H=C(H^L,8),S=S+H|0,B=C(B^S,7),I=I+v|0,E=C(E^I,16),K=K+E|0,v=C(v^K,12),I=I+v|0,E=C(E^I,8),K=K+E|0,v=C(v^K,7),U=U+_|0,R=C(R^U,16),N=N+R|0,_=C(_^N,12),U=U+_|0,R=C(R^U,8),N=N+R|0,_=C(_^N,7),b=b+A|0,M=C(M^b,16),P=P+M|0,A=C(A^P,12),b=b+A|0,M=C(M^b,8),P=P+M|0,A=C(A^P,7),L=L+v|0,M=C(M^L,16),N=N+M|0,v=C(v^N,12),L=L+v|0,M=C(M^L,8),N=N+M|0,v=C(v^N,7),I=I+_|0,H=C(H^I,16),P=P+H|0,_=C(_^P,12),I=I+_|0,H=C(H^I,8),P=P+H|0,_=C(_^P,7),U=U+A|0,E=C(E^U,16),S=S+E|0,A=C(A^S,12),U=U+A|0,E=C(E^U,8),S=S+E|0,A=C(A^S,7),b=b+B|0,R=C(R^b,16),K=K+R|0,B=C(B^K,12),b=b+B|0,R=C(R^b,8),K=K+R|0,B=C(B^K,7);let G=0;r[G++]=i+L|0,r[G++]=c+I|0,r[G++]=f+U|0,r[G++]=l+b|0,r[G++]=u+B|0,r[G++]=d+v|0,r[G++]=a+_|0,r[G++]=y+A|0,r[G++]=h+S|0,r[G++]=g+K|0,r[G++]=x+N|0,r[G++]=p+P|0,r[G++]=w+H|0,r[G++]=m+E|0,r[G++]=O+R|0,r[G++]=T+M|0}function Do(e,t,n,r){let o=e[0],s=e[1],i=e[2],c=e[3],f=t[0],l=t[1],u=t[2],d=t[3],a=t[4],y=t[5],h=t[6],g=t[7],x=n[0],p=n[1],w=n[2],m=n[3];for(let T=0;T<20;T+=2)o=o+f|0,x=C(x^o,16),a=a+x|0,f=C(f^a,12),o=o+f|0,x=C(x^o,8),a=a+x|0,f=C(f^a,7),s=s+l|0,p=C(p^s,16),y=y+p|0,l=C(l^y,12),s=s+l|0,p=C(p^s,8),y=y+p|0,l=C(l^y,7),i=i+u|0,w=C(w^i,16),h=h+w|0,u=C(u^h,12),i=i+u|0,w=C(w^i,8),h=h+w|0,u=C(u^h,7),c=c+d|0,m=C(m^c,16),g=g+m|0,d=C(d^g,12),c=c+d|0,m=C(m^c,8),g=g+m|0,d=C(d^g,7),o=o+l|0,m=C(m^o,16),h=h+m|0,l=C(l^h,12),o=o+l|0,m=C(m^o,8),h=h+m|0,l=C(l^h,7),s=s+u|0,x=C(x^s,16),g=g+x|0,u=C(u^g,12),s=s+u|0,x=C(x^s,8),g=g+x|0,u=C(u^g,7),i=i+d|0,p=C(p^i,16),a=a+p|0,d=C(d^a,12),i=i+d|0,p=C(p^i,8),a=a+p|0,d=C(d^a,7),c=c+f|0,w=C(w^c,16),y=y+w|0,f=C(f^y,12),c=c+f|0,w=C(w^c,8),y=y+w|0,f=C(f^y,7);let O=0;r[O++]=o,r[O++]=s,r[O++]=i,r[O++]=c,r[O++]=x,r[O++]=p,r[O++]=w,r[O++]=m}var qo=We(gr,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Go=We(gr,{counterRight:!1,counterLength:8,extendNonceFn:Do,allowShortKeys:!1});var Jo=new Uint8Array(16),yr=(e,t)=>{e.update(t);let n=t.length%16;n&&e.update(Jo.subarray(n))},Vo=new Uint8Array(32);function xr(e,t,n,r,o){let s=e(t,n,Vo),i=pr.create(s);o&&yr(i,o),yr(i,r);let c=ur(r.length,o?o.length:0,!0);i.update(c);let f=i.digest();return St(s,c),f}var mr=e=>(t,n,r)=>({encrypt(s,i){let c=s.length;i=ze(c+16,i,!1),i.set(s);let f=i.subarray(0,-16);e(t,n,f,f,1);let l=xr(e,t,n,f,r);return i.set(l,c),St(l),i},decrypt(s,i){i=ze(s.length-16,i,!1);let c=s.subarray(0,-16),f=s.subarray(-16),l=xr(e,t,n,c,r);if(!ar(f,l))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),e(t,n,i,i,1),St(l),i}}),Ws=Xe({blockSize:64,nonceLength:12,tagLength:16},mr(qo)),oe=Xe({blockSize:64,nonceLength:24,tagLength:16},mr(Go));var Ae=class extends kt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,jt(t);let r=vt(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),nt(s)}update(t){return Dt(this),this.iHash.update(t),this}digestInto(t){Dt(this),j(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Ee=(e,t,n)=>new Ae(e,t).update(n).digest();Ee.create=(e,t)=>new Ae(e,t);function Zo(e,t,n){return jt(e),n===void 0&&(n=new Uint8Array(e.outputLen)),Ee(e,vt(n),vt(t))}var tn=Uint8Array.from([0]),br=Uint8Array.of();function $o(e,t,n,r=32){jt(e),Nt(r);let o=e.outputLen;if(r>255*o)throw new Error("Length should be <= 255*HashLen");let s=Math.ceil(r/o);n===void 0&&(n=br);let i=new Uint8Array(s*o),c=Ee.create(e,t),f=c._cloneInto(),l=new Uint8Array(c.outputLen);for(let u=0;u<s;u++)tn[0]=u+1,f.update(u===0?br:l).update(n).update(tn).digestInto(l),i.set(l,o*u),c._cloneInto(f);return c.destroy(),f.destroy(),nt(l,tn),i.slice(0,r)}var lt=(e,t,n,r,o)=>$o(e,Zo(e,t,n),r,o);var dt=_n;var Mt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function st(e=32){if(Mt&&typeof Mt.getRandomValues=="function")return Mt.getRandomValues(new Uint8Array(e));if(Mt&&typeof Mt.randomBytes=="function")return Uint8Array.from(Mt.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}var Zt=24,$t=12,W=32;function k(e){let t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}function D(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function q(e){e.fill(0)}function wr(){let e=st(32),t=At.getPublicKey(e),n=JSON.stringify({success:!0,privateKeyBase64:D(e),publicKeyBase64:D(t)});return q(e),n}function Br(e){try{let t=k(e),n=At.getPublicKey(t);return q(t),D(n)}catch{return""}}function Se(e,t){return At.getSharedSecret(e,t)}function Ar(){let e=st(32),t=tt.getPublicKey(e),n=JSON.stringify({success:!0,privateKeyBase64:D(e),publicKeyBase64:D(t)});return q(e),n}function Er(e){try{let t=k(e),n=tt.getPublicKey(t);return q(t),D(n)}catch{return""}}function Sr(e,t){try{let n=k(e),r=k(t),o=tt.sign(n,r);return q(r),JSON.stringify({success:!0,signatureBase64:D(o)})}catch(n){return JSON.stringify({success:!1,error:`Signing failed: ${n instanceof Error?n.message:"Unknown error"}`})}}function vr(e,t,n){try{let r=k(e),o=k(t),s=k(n);return tt.verify(o,r,s)}catch{return!1}}function Cr(e,t){try{let n=k(e),r=k(t);if(r.length!==W)return JSON.stringify({success:!1,error:`Invalid key length: expected ${W}, got ${r.length}`});let o=st(Zt),i=oe(r,o).encrypt(n);return q(r),JSON.stringify({success:!0,ciphertextBase64:D(i),nonceBase64:D(o)})}catch(n){return JSON.stringify({success:!1,error:`Encryption failed: ${n instanceof Error?n.message:"Unknown error"}`})}}function Or(e,t,n){try{let r=k(e),o=k(t),s=k(n);if(s.length!==W)return JSON.stringify({success:!1,error:`Invalid key length: expected ${W}, got ${s.length}`});if(o.length!==Zt)return JSON.stringify({success:!1,error:`Invalid nonce length: expected ${Zt}, got ${o.length}`});let c=oe(s,o).decrypt(r);return q(s),JSON.stringify({success:!0,plaintextBase64:D(c)})}catch(r){return JSON.stringify({success:!1,error:`Decryption failed: ${r instanceof Error?r.message:"Unknown error"}`})}}async function _r(e,t){try{let n=k(e),r=k(t);if(r.length!==W)return JSON.stringify({success:!1,error:`Invalid key length: expected ${W}, got ${r.length}`});let o=await crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!1,["encrypt"]),s=st($t),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:s},o,n);return q(r),JSON.stringify({success:!0,ciphertextBase64:D(new Uint8Array(i)),nonceBase64:D(s)})}catch(n){return JSON.stringify({success:!1,error:`AES-GCM encryption failed: ${n instanceof Error?n.message:"Unknown error"}`})}}async function Kr(e,t,n){try{let r=k(e),o=k(t),s=k(n);if(s.length!==W)return JSON.stringify({success:!1,error:`Invalid key length: expected ${W}, got ${s.length}`});if(o.length!==$t)return JSON.stringify({success:!1,error:`Invalid nonce length: expected ${$t}, got ${o.length}`});let i=await crypto.subtle.importKey("raw",s,{name:"AES-GCM"},!1,["decrypt"]),c=await crypto.subtle.decrypt({name:"AES-GCM",iv:o},i,r);return q(s),JSON.stringify({success:!0,plaintextBase64:D(new Uint8Array(c))})}catch(r){return JSON.stringify({success:!1,error:`AES-GCM decryption failed: ${r instanceof Error?r.message:"Unknown error"}`})}}function Ur(e,t){try{let n=k(e),r=k(t);if(r.length!==W)return JSON.stringify({success:!1,error:`Invalid public key length: expected ${W}, got ${r.length}`});let o=st(32),s=At.getPublicKey(o),i=Se(o,r),c=lt(dt,i,void 0,"ecies-xchacha20poly1305",32),f=st(Zt),u=oe(c,f).encrypt(n);return q(o),q(i),q(c),JSON.stringify({success:!0,ephemeralPublicKeyBase64:D(s),ciphertextBase64:D(u),nonceBase64:D(f)})}catch(n){return JSON.stringify({success:!1,error:`Asymmetric encryption failed: ${n instanceof Error?n.message:"Unknown error"}`})}}function Nr(e,t,n,r){try{let o=k(e),s=k(t),i=k(n),c=k(r);if(c.length!==W)return JSON.stringify({success:!1,error:`Invalid private key length: expected ${W}, got ${c.length}`});if(i.length!==Zt)return JSON.stringify({success:!1,error:`Invalid nonce length: expected ${Zt}, got ${i.length}`});let f=Se(c,o),l=lt(dt,f,void 0,"ecies-xchacha20poly1305",32),d=oe(l,i).decrypt(s);return q(c),q(f),q(l),JSON.stringify({success:!0,plaintextBase64:D(d)})}catch(o){return JSON.stringify({success:!1,error:`Asymmetric decryption failed: ${o instanceof Error?o.message:"Unknown error"}`})}}async function Ir(e,t){try{let n=k(e),r=k(t);if(r.length!==W)return JSON.stringify({success:!1,error:`Invalid public key length: expected ${W}, got ${r.length}`});let o=st(32),s=At.getPublicKey(o),i=Se(o,r),c=lt(dt,i,void 0,"ecies-aes-gcm",32),f=await crypto.subtle.importKey("raw",c,{name:"AES-GCM"},!1,["encrypt"]),l=st($t),u=await crypto.subtle.encrypt({name:"AES-GCM",iv:l},f,n);return q(o),q(i),q(c),JSON.stringify({success:!0,ephemeralPublicKeyBase64:D(s),ciphertextBase64:D(new Uint8Array(u)),nonceBase64:D(l)})}catch(n){return JSON.stringify({success:!1,error:`Asymmetric encryption failed: ${n instanceof Error?n.message:"Unknown error"}`})}}async function Pr(e,t,n,r){try{let o=k(e),s=k(t),i=k(n),c=k(r);if(c.length!==W)return JSON.stringify({success:!1,error:`Invalid private key length: expected ${W}, got ${c.length}`});if(i.length!==$t)return JSON.stringify({success:!1,error:`Invalid nonce length: expected ${$t}, got ${i.length}`});let f=Se(c,o),l=lt(dt,f,void 0,"ecies-aes-gcm",32),u=await crypto.subtle.importKey("raw",l,{name:"AES-GCM"},!1,["decrypt"]),d=await crypto.subtle.decrypt({name:"AES-GCM",iv:i},u,s);return q(c),q(f),q(l),JSON.stringify({success:!0,plaintextBase64:D(new Uint8Array(d))})}catch(o){return JSON.stringify({success:!1,error:`Asymmetric decryption failed: ${o instanceof Error?o.message:"Unknown error"}`})}}function Tr(e){try{let t=k(e),n=lt(dt,t,void 0,"x25519-key",32),r=At.getPublicKey(n),o=JSON.stringify({success:!0,privateKeyBase64:D(n),publicKeyBase64:D(r)});return q(t),q(n),o}catch(t){return JSON.stringify({success:!1,error:`Key derivation failed: ${t instanceof Error?t.message:"Unknown error"}`})}}function Lr(e){try{let t=k(e),n=lt(dt,t,void 0,"ed25519-key",32),r=tt.getPublicKey(n),o=JSON.stringify({success:!0,privateKeyBase64:D(n),publicKeyBase64:D(r)});return q(t),q(n),o}catch(t){return JSON.stringify({success:!1,error:`Key derivation failed: ${t instanceof Error?t.message:"Unknown error"}`})}}function Hr(e){try{let t=k(e),n=lt(dt,t,void 0,"x25519-key",32),r=At.getPublicKey(n),o=lt(dt,t,void 0,"ed25519-key",32),s=tt.getPublicKey(o),i=JSON.stringify({success:!0,x25519PrivateKeyBase64:D(n),x25519PublicKeyBase64:D(r),ed25519PrivateKeyBase64:D(o),ed25519PublicKeyBase64:D(s)});return q(t),q(n),q(o),i}catch(t){return JSON.stringify({success:!1,error:`Key derivation failed: ${t instanceof Error?t.message:"Unknown error"}`})}}async function Rr(e,t){try{let n=k(e),r=lt(dt,n,void 0,t,32),o=D(r);return q(n),q(r),o}catch(n){throw new Error(`HKDF key derivation failed: ${n instanceof Error?n.message:"Unknown error"}`)}}function Mr(e){let t=st(e);return D(t)}function kr(){try{let e=st(32);return At.getPublicKey(e),tt.getPublicKey(e),!(typeof crypto>"u"||typeof crypto.subtle>"u")}catch{return!1}}async function jo(){return fn()}async function Xo(){return an()}async function zo(e,t){let n=JSON.parse(t),r=await un(e,n);return JSON.stringify(r)}async function Yo(e,t,n){let r=JSON.parse(n),o=await dn(e,t,r);return!o.success||!o.value?JSON.stringify({success:!1,errorCode:o.errorCode,cancelled:o.cancelled}):JSON.stringify({success:!0,value:o.value})}async function Wo(e,t){let n=JSON.parse(t),r=await hn(e,n);return!r.success||!r.value?JSON.stringify({success:!1,errorCode:r.errorCode,cancelled:r.cancelled}):JSON.stringify({success:!0,value:{credentialId:r.value.credentialId,prfOutput:r.value.prfOutput}})}var Dr={isPrfSupported:jo,isConditionalMediationAvailable:Xo,register:zo,evaluatePrfOutput:Yo,evaluatePrfDiscoverableOutput:Wo},qr={generateX25519KeyPair:wr,getX25519PublicKey:Br,deriveX25519KeyPair:Tr,generateEd25519KeyPair:Ar,getEd25519PublicKey:Er,deriveEd25519KeyPair:Lr,ed25519Sign:Sr,ed25519Verify:vr,deriveDualKeyPair:Hr,encryptChaCha:Cr,decryptChaCha:Or,encryptAesGcm:_r,decryptAesGcm:Kr,encryptAsymmetricChaCha:Ur,decryptAsymmetricChaCha:Nr,encryptAsymmetricAesGcm:Ir,decryptAsymmetricAesGcm:Pr,deriveHkdfKey:Rr,generateRandomBytes:Mr,isSupported:kr};globalThis.blazorPrf=Dr;globalThis.blazorPrfNoble=qr;var wi={blazorPrf:Dr,blazorPrfNoble:qr};export{wi as default,Wo as evaluatePrfDiscoverableOutput,Yo as evaluatePrfOutput,Xo as isConditionalMediationAvailable,jo as isPrfSupported,zo as register};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
